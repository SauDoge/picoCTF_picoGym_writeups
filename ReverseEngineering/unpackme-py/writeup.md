# Unpackme-py

## Given 
- A python file 'unpackme.flag.py'

## Process
- Execute the python script
- It is asking for us to enter a password. 
- Study the python script
- A [Fernet](https://cryptography.io/en/latest/fernet/) token is generated by encrypting with key `key_str` in base64. This token is indeed the `payload` and that is why we can decrypt the `payload` with the same key.
- The `payload` is decrypted into `plain`.
- The `plain` is then decoded and passed to `exec()`.
- Therefore, the decoded `plain` is holding the string of a python script that can be run by [`exec()`](https://www.tutorialspoint.com/exec-in-python). 

## Solution
- Print the decoded `plain` instead of executing it
``` python
print(plain.decode())
```
- The script content of `plain` will be printed and the flag is there written in plaintext.
```python
pw = input('What\'s the password? ')

if pw == 'batteryhorse':
  print('picoCTF{175_chr157m45_5274ff21}')
else:
  print('That password is incorrect.')
```

## Flag 
> picoCTF{175_chr157m45_5274ff21}